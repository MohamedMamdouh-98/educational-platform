<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/png"
      href="../../assets/img/favicon/favicon.png"
    />
    <!--=============== REMIXICONS ===============-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css"
    />

    <!--=============== CSS ===============-->
    <link rel="stylesheet" href="../../assets/css/styles.css" />
    <link rel="stylesheet" href="../../assets/css/modules.css" />
    <!-- Font Awesome 6 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <title>Module Details</title>
  </head>
  <body>
    <!--=============== HEADER ===============-->
    <header class="header" id="header">
      <div class="header__container">
        <a href="#" class="header__logo">
          <i class="ri-cloud-fill"></i>
          <span>LOGO</span>
        </a>

        <button class="header__toggle" id="header-toggle">
          <i class="ri-menu-line"></i>
        </button>
      </div>
    </header>

    <!--=============== SIDEBAR ===============-->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar__container">
        <div class="sidebar__user">
          <div class="sidebar__img">
            <img src="../../assets/img/user.png" alt="image" />
          </div>

          <div class="sidebar__info">
            <h3>user name</h3>
            <span>text123@email.com</span>
          </div>
        </div>

        <div class="sidebar__content">
          <div>
            <!-- <h3 class="sidebar__title">MANAGE</h3> -->

            <div class="sidebar__list">
              <a href="../home/" class="sidebar__link">
                <i class="ri-focus-2-line"></i>
                <span>Objectives</span>
              </a>

              <a href="../../pre-assessments/" class="sidebar__link">
                <i class="ri-file-list-3-fill"></i>
                <span>Pre-Assessments</span>
              </a>

              <a href="../../modules/" class="sidebar__link active-link">
                <i class="ri-book-open-fill"></i>
                <span>Modules</span>
              </a>

              <a href="#" class="sidebar__link">
                <i class="ri-file-list-3-fill"></i>
                <span>Post Assessment</span>
              </a>
            </div>
          </div>
        </div>

        <div class="sidebar__actions">
          <button>
            <i
              class="ri-moon-clear-fill sidebar__link sidebar__theme"
              id="theme-button"
            >
              <span>Theme</span>
            </i>
          </button>

          <button class="sidebar__link" id="btn-log-out">
            <i class="ri-logout-box-r-fill"></i>
            <span>Log Out</span>
          </button>
        </div>
      </div>
    </nav>

    <!--=============== MAIN ===============-->
    <main class="main" id="main">
      <div class="module-details" id="module-details">
        <div class="container">
          <div class="lesson-content">
            <!-- LEARNING OBJECTIVES -->
            <section class="objectives-section">
              <h2><i class="fas fa-bullseye"></i> Learning Objectives</h2>
              <div class="objectives-container">
                <div class="objectives-list" id="module-objectives"></div>
              </div>
            </section>
            <!-- VIDEO -->
            <section class="video-section">
              <h2><i class="fas fa-play-circle"></i> Video Tutorial</h2>
              <div class="video-wrapper">
                <div class="video-container">
                  <iframe
                    id="module-video"
                    src=""
                    frameborder="0"
                    allow="
                      accelerometer;
                      autoplay;
                      clipboard-write;
                      encrypted-media;
                      gyroscope;
                      picture-in-picture;
                    "
                    allowfullscreen
                  ></iframe>
                </div>
                <div class="video-info">
                  <h3 id="module-title"></h3>
                  <p id="module-description"></p>
                </div>
              </div>
            </section>

            <!-- SLIDER / BOOK -->
            <!-- <section class="slider-section">
              <div class="slider-container">
                <div class="book-wrapper" id="book-container">
                  <div id="book"></div>
                </div>
              </div>
            </section> -->

            <div class="guide-section">
              <div class="guide-icon">
                <i class="fas fa-book-open"></i>
              </div>

              <h1 class="guide-title">Your Digital Textbook Is Ready</h1>

              <p class="guide-description">
                This course includes a digital textbook that contains all the
                essential learning content. To view the book, simply use the
                button below.
              </p>

              <div class="guide-instruction">
                <div class="instruction-icon">1</div>
                <h3>How to Access the Book</h3>
                <p>
                  Click the button below to open the digital textbook. The book
                  will be displayed in an interactive view where you can read
                  and navigate through all course materials.
                </p>
              </div>

              <button class="guide-button">
                Open Digital Textbook
                <i class="fas fa-arrow-right"></i>
              </button>

              <div class="guide-note">
                <i class="fas fa-info-circle"></i>
                Note: Please ensure you have an active internet connection to
                load the textbook properly.
              </div>
            </div>

            <div class="book-modal" id="bookModal">
              <div class="book-modal__overlay"></div>

              <div class="book-modal__content">
                <button class="book-modal__close">&times;</button>

                <div class="book-wrapper" id="book-container">
                  <div id="book"></div>
                </div>
              </div>
            </div>

            <!-- QUIZ -->
            <section class="quiz-section">
              <div class="quiz-header">
                <h2><i class="fas fa-question-circle"></i> Quiz Question</h2>
                <div class="quiz-progress">
                  <div class="progress-bar">
                    <div
                      class="progress-fill"
                      id="quiz-progress-fill"
                      style="width: 0%"
                    ></div>
                  </div>
                  <span id="quiz-progress-text">Question 0 of 0</span>
                </div>
              </div>

              <div class="question-container">
                <div class="question" id="quiz-question"></div>
                <div class="options-grid" id="quiz-options"></div>
              </div>

              <div class="quiz-actions">
                <button class="quiz-btn check-btn" id="check-btn">
                  <i class="fas fa-check-circle"></i> Check Answer
                </button>
                <!-- <button class="quiz-btn hint-btn" id="hint-btn">
                  <i class="fas fa-lightbulb"></i> Show Hint
                </button> -->
                <div class="quiz-navigation">
                  <button class="quiz-btn prev-btn" id="prev-btn">
                    <i class="fas fa-arrow-left"></i>
                    Previous Question
                  </button>

                  <button class="quiz-btn next-btn" id="next-btn">
                    Next Question
                    <i class="fas fa-arrow-right"></i>
                  </button>
                </div>
              </div>

              <div class="result-container" id="quiz-result"></div>
            </section>
          </div>
        </div>
      </div>
    </main>
    <button id="scrollTopBtn" aria-label="Scroll to top">
      <i class="fas fa-arrow-up"></i>
    </button>

    <!--=============== MAIN JS ===============-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../../assets/js/auth-guard.js"></script>

    <script src="../../data/modules-data.js"></script>
    <script src="../../assets/js/main.js"></script>
    <!-- <script src="../../assets/js/modules.js"></script> -->
    <script src="../../assets/js/module-details.js"></script>
    <script src="../../assets/js/turn.min.js"></script>

    <!-- <script>
      function initBook() {
        const screenWidth = $(window).width();
        let bookWidth, bookHeight, displayMode;

        if (screenWidth < 576) {
          // موبايل
          bookWidth = screenWidth - 20;
          bookHeight = bookWidth * 1.4;
          displayMode = "single";
        } else if (screenWidth < 992) {
          // تابلت
          bookWidth = screenWidth * 0.9;
          bookHeight = bookWidth * 0.6;
          displayMode = "double";
        } else {
          // شاشات كبيرة (Desktop)
          bookWidth = 650;
          bookHeight = 550;
          displayMode = "double";
        }

        if ($("#book").data("turn")) {
          $("#book").turn("destroy");
        }

        $("#book").turn({
          width: bookWidth,
          height: bookHeight,
          autoCenter: true,
          display: displayMode,
        });
      }

      $(document).ready(function () {
        initBook();
      });

      $(window).on("resize", function () {
        initBook();
      });
    </script> -->

    <!--==================================-->
    <script>
      function initBook() {
        const $book = $("#book");

        // ❌ ما تهيّئش الكتاب وهو مخفي
        if (!$book.is(":visible")) return;

        const screenWidth = $(window).width();
        let bookWidth, bookHeight, displayMode;

        if (screenWidth < 576) {
          // موبايل
          bookWidth = screenWidth - 20;
          bookHeight = bookWidth * 1.4;
          displayMode = "single";
        } else if (screenWidth < 992) {
          // تابلت
          bookWidth = screenWidth * 0.9;
          bookHeight = bookWidth * 0.6;
          displayMode = "double";
        } else {
          // Desktop
          bookWidth = 650;
          bookHeight = 550;
          displayMode = "double";
        }

        // إعادة التهيئة لو كان شغال قبل كده
        if ($book.data("turn")) {
          $book.turn("destroy");
        }

        $book.turn({
          width: bookWidth,
          height: bookHeight,
          autoCenter: true,
          display: displayMode,
        });
      }

      document.addEventListener("DOMContentLoaded", () => {
        const openBtn = document.querySelector(".guide-button");
        const modal = document.getElementById("bookModal");
        const closeBtn = modal.querySelector(".book-modal__close");
        const overlay = modal.querySelector(".book-modal__overlay");

        openBtn.addEventListener("click", () => {
          modal.classList.add("active");
          document.body.classList.add("modal-open");

          // ⏱️ انتظر المودال يظهر
          setTimeout(() => {
            initBook();
          }, 100);
        });

        function closeModal() {
          modal.classList.remove("active");
          document.body.classList.remove("modal-open");
        }

        closeBtn.addEventListener("click", closeModal);
        overlay.addEventListener("click", closeModal);

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") closeModal();
        });
      });

      // إعادة الحساب عند تغيير حجم الشاشة
      $(window).on("resize", function () {
        if ($("#book").is(":visible")) {
          initBook();
        }
      });
    </script>
  </body>
</html>
